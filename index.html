<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>O2 Pulse â€” Concept A: Clinical Monitor</title>
<style>
/* ============================================
   RESET & BASE
   ============================================ */
*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

:root {
  --font: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'SF Pro Text', system-ui, sans-serif;

  /* Dark theme (default) */
  --page-bg: #050510;
  --frame-border: #2a2a2e;
  --frame-shadow: rgba(0,0,0,0.6);
  --app-bg: #0a0a14;
  --mesh-1: rgba(60, 30, 140, 0.4);
  --mesh-2: rgba(0, 100, 180, 0.3);
  --mesh-3: rgba(0, 160, 120, 0.15);
  --mesh-4: rgba(100, 40, 180, 0.2);

  --glass-bg: rgba(255,255,255,0.07);
  --glass-border: rgba(255,255,255,0.15);
  --glass-highlight: rgba(255,255,255,0.25);
  --glass-shadow: rgba(0,0,0,0.3);
  --glass-blur: 40px;

  --text-primary: rgba(255,255,255,0.95);
  --text-secondary: rgba(255,255,255,0.55);
  --text-tertiary: rgba(255,255,255,0.35);

  --green: #30d158;
  --yellow: #ffd60a;
  --red: #ff3b30;
  --blue: #0a84ff;
  --orange: #ff9f0a;
  --cyan: #64d2ff;
  --teal: #30b0c7;
  --purple: #bf5af2;

  --tab-bg: rgba(255,255,255,0.04);
  --tab-border: rgba(255,255,255,0.08);
  --tab-active: rgba(255,255,255,0.12);

  --toggle-bg: rgba(255,255,255,0.1);
  --toggle-active: var(--green);
  --input-bg: rgba(255,255,255,0.06);
  --input-border: rgba(255,255,255,0.12);

  --home-indicator: rgba(255,255,255,0.3);
}

[data-theme="light"] {
  --page-bg: #e8e8f0;
  --frame-border: #c0c0c8;
  --frame-shadow: rgba(0,0,0,0.15);
  --app-bg: #f2f2f7;
  --mesh-1: rgba(140, 120, 255, 0.2);
  --mesh-2: rgba(80, 180, 255, 0.15);
  --mesh-3: rgba(60, 200, 160, 0.1);
  --mesh-4: rgba(200, 140, 255, 0.15);

  --glass-bg: rgba(255,255,255,0.55);
  --glass-border: rgba(255,255,255,0.7);
  --glass-highlight: rgba(255,255,255,0.8);
  --glass-shadow: rgba(0,0,0,0.06);

  --text-primary: rgba(0,0,0,0.85);
  --text-secondary: rgba(0,0,0,0.5);
  --text-tertiary: rgba(0,0,0,0.3);

  --tab-bg: rgba(0,0,0,0.03);
  --tab-border: rgba(0,0,0,0.06);
  --tab-active: rgba(0,0,0,0.08);

  --toggle-bg: rgba(0,0,0,0.1);
  --input-bg: rgba(0,0,0,0.04);
  --input-border: rgba(0,0,0,0.08);

  --home-indicator: rgba(0,0,0,0.2);
}

body {
  font-family: var(--font);
  background: var(--page-bg);
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 20px;
  transition: background 0.5s ease;
  overflow-x: hidden;
}

/* ============================================
   PAGE HEADER
   ============================================ */
.page-header {
  text-align: center;
  margin-bottom: 24px;
  color: var(--text-primary);
  transition: color 0.5s ease;
}
.page-header h1 {
  font-size: 20px;
  font-weight: 600;
  letter-spacing: -0.3px;
  margin-bottom: 6px;
}
.page-header p {
  font-size: 13px;
  color: var(--text-secondary);
}
.theme-toggle-page {
  display: inline-flex;
  align-items: center;
  gap: 10px;
  margin-top: 12px;
  padding: 8px 18px;
  background: var(--glass-bg);
  border: 1px solid var(--glass-border);
  border-radius: 100px;
  cursor: pointer;
  color: var(--text-primary);
  font-size: 14px;
  font-weight: 500;
  font-family: var(--font);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  transition: all 0.3s ease;
}
.theme-toggle-page:hover {
  background: var(--tab-active);
}
.theme-icon { font-size: 16px; }

/* ============================================
   iPHONE FRAME
   ============================================ */
.iphone-wrapper {
  position: relative;
}
.iphone-frame {
  width: 393px;
  height: 852px;
  border-radius: 55px;
  border: 4px solid var(--frame-border);
  overflow: hidden;
  position: relative;
  background: var(--app-bg);
  box-shadow:
    0 0 0 1px rgba(255,255,255,0.05),
    0 20px 60px var(--frame-shadow),
    0 4px 16px var(--frame-shadow),
    inset 0 0 0 1px rgba(255,255,255,0.03);
  transition: border-color 0.5s ease, box-shadow 0.5s ease, background 0.5s ease;
}

/* Animated mesh gradient background */
.mesh-bg {
  position: absolute;
  inset: 0;
  z-index: 0;
  overflow: hidden;
  transition: background 0.5s ease;
  background: var(--app-bg);
}
.mesh-bg::before {
  content: '';
  position: absolute;
  width: 200%;
  height: 200%;
  top: -50%;
  left: -50%;
  background:
    radial-gradient(circle at 25% 25%, var(--mesh-1) 0%, transparent 50%),
    radial-gradient(circle at 75% 20%, var(--mesh-2) 0%, transparent 45%),
    radial-gradient(circle at 55% 75%, var(--mesh-3) 0%, transparent 50%),
    radial-gradient(circle at 20% 70%, var(--mesh-4) 0%, transparent 45%);
  animation: meshDrift 25s ease-in-out infinite alternate;
}
@keyframes meshDrift {
  0% { transform: translate(0, 0) rotate(0deg) scale(1); }
  33% { transform: translate(20px, -15px) rotate(1deg) scale(1.02); }
  66% { transform: translate(-15px, 10px) rotate(-0.5deg) scale(0.99); }
  100% { transform: translate(5px, -5px) rotate(0.5deg) scale(1.01); }
}

/* Dynamic Island */
.dynamic-island {
  position: absolute;
  top: 12px;
  left: 50%;
  transform: translateX(-50%);
  width: 126px;
  height: 37px;
  background: #000;
  border-radius: 20px;
  z-index: 50;
}

/* Status Bar (iOS style) */
.status-bar {
  position: absolute;
  top: 14px;
  left: 0;
  right: 0;
  height: 20px;
  z-index: 40;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0 32px;
  font-size: 14px;
  font-weight: 600;
  color: var(--text-primary);
}
.status-bar-right {
  display: flex;
  gap: 5px;
  align-items: center;
  font-size: 12px;
}
.status-bar-right svg { width: 16px; height: 16px; }

/* ============================================
   APP CONTENT
   ============================================ */
.app-content {
  position: absolute;
  top: 58px;
  left: 0;
  right: 0;
  bottom: 84px;
  z-index: 10;
  overflow: hidden;
}
.app-screen {
  position: absolute;
  inset: 0;
  padding: 0 16px;
  overflow-y: auto;
  overflow-x: hidden;
  opacity: 0;
  transform: translateX(30px);
  transition: opacity 0.35s ease, transform 0.35s ease;
  pointer-events: none;
  -webkit-overflow-scrolling: touch;
  scrollbar-width: none;
}
.app-screen::-webkit-scrollbar { display: none; }
.app-screen.active {
  opacity: 1;
  transform: translateX(0);
  pointer-events: auto;
}

/* ============================================
   LIQUID GLASS COMPONENTS
   ============================================ */
.glass-card {
  position: relative;
  background: var(--glass-bg);
  backdrop-filter: blur(var(--glass-blur)) saturate(180%);
  -webkit-backdrop-filter: blur(var(--glass-blur)) saturate(180%);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
  padding: 16px;
  overflow: hidden;
  box-shadow:
    0 4px 24px var(--glass-shadow),
    inset 0 1px 0 rgba(255,255,255,0.15);
  transition: background 0.4s ease, border-color 0.4s ease, box-shadow 0.4s ease;
}
.glass-card::before {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: inherit;
  background: radial-gradient(ellipse 70% 45% at 50% 0%, var(--glass-highlight) 0%, transparent 60%);
  pointer-events: none;
  opacity: 0.4;
}
.glass-card::after {
  content: '';
  position: absolute;
  top: 0;
  left: 10%;
  right: 10%;
  height: 1px;
  background: linear-gradient(90deg, transparent, var(--glass-highlight), transparent);
  pointer-events: none;
}

/* ============================================
   CONNECTION STATUS PILL
   ============================================ */
.connection-pill {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 6px 14px 6px 10px;
  background: var(--glass-bg);
  backdrop-filter: blur(20px) saturate(150%);
  -webkit-backdrop-filter: blur(20px) saturate(150%);
  border: 1px solid var(--glass-border);
  border-radius: 100px;
  font-size: 12px;
  font-weight: 500;
  color: var(--text-primary);
  margin-bottom: 12px;
  transition: all 0.4s ease;
}
.connection-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: var(--green);
  box-shadow: 0 0 8px var(--green);
  animation: pulse-dot 2s ease-in-out infinite;
}
@keyframes pulse-dot {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}
.connection-pill .watch-icon {
  width: 16px;
  height: 16px;
  opacity: 0.7;
}
.connection-pill .battery {
  font-size: 11px;
  color: var(--text-secondary);
}

/* ============================================
   SpO2 RADIAL GAUGE
   ============================================ */
.spo2-section {
  text-align: center;
  margin-bottom: 12px;
}
.spo2-gauge {
  position: relative;
  width: 200px;
  height: 200px;
  margin: 0 auto 8px;
}
.spo2-gauge svg {
  width: 100%;
  height: 100%;
  transform: rotate(-90deg);
}
.gauge-track {
  fill: none;
  stroke: rgba(255,255,255,0.06);
  stroke-width: 12;
  stroke-linecap: round;
}
[data-theme="light"] .gauge-track {
  stroke: rgba(0,0,0,0.06);
}
.gauge-fill {
  fill: none;
  stroke-width: 12;
  stroke-linecap: round;
  transition: stroke-dasharray 1s ease, stroke 0.5s ease;
  filter: drop-shadow(0 0 6px var(--green));
}
.gauge-glow {
  fill: none;
  stroke-width: 20;
  stroke-linecap: round;
  opacity: 0.15;
  transition: stroke-dasharray 1s ease, stroke 0.5s ease;
}
.spo2-value-group {
  position: absolute;
  inset: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}
.spo2-value {
  font-size: 56px;
  font-weight: 700;
  letter-spacing: -3px;
  color: var(--text-primary);
  line-height: 1;
  animation: breathe 4s ease-in-out infinite;
}
.spo2-unit {
  font-size: 18px;
  font-weight: 400;
  color: var(--text-secondary);
  letter-spacing: 0;
}
.spo2-label {
  font-size: 13px;
  font-weight: 500;
  color: var(--text-secondary);
  margin-top: 2px;
}
.spo2-status {
  font-size: 12px;
  font-weight: 600;
  margin-top: 4px;
  padding: 2px 10px;
  border-radius: 100px;
  background: rgba(48, 209, 88, 0.15);
  color: var(--green);
}
@keyframes breathe {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.015); }
}

/* ============================================
   PULSE DISPLAY
   ============================================ */
.pulse-section {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  margin-bottom: 16px;
}
.pulse-heart {
  font-size: 20px;
  animation: heartbeat 1s ease-in-out infinite;
  color: var(--red);
}
@keyframes heartbeat {
  0%, 100% { transform: scale(1); }
  15% { transform: scale(1.25); }
  30% { transform: scale(1); }
  45% { transform: scale(1.15); }
  60% { transform: scale(1); }
}
.pulse-value {
  font-size: 28px;
  font-weight: 600;
  color: var(--text-primary);
  letter-spacing: -1px;
}
.pulse-unit {
  font-size: 14px;
  color: var(--text-secondary);
  font-weight: 400;
}

/* ============================================
   PPG WAVEFORM
   ============================================ */
.ppg-section {
  margin-bottom: 16px;
}
.ppg-card {
  padding: 12px;
}
.ppg-label {
  font-size: 11px;
  font-weight: 500;
  color: var(--text-tertiary);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 8px;
}
.ppg-canvas {
  width: 100%;
  height: 60px;
  display: block;
  border-radius: 8px;
}

/* ============================================
   PERIOD SELECTOR + CHART
   ============================================ */
.chart-section {
  margin-bottom: 20px;
}
.period-selector {
  display: flex;
  gap: 2px;
  padding: 3px;
  background: var(--tab-bg);
  border-radius: 10px;
  border: 1px solid var(--tab-border);
  margin-bottom: 12px;
}
.period-btn {
  flex: 1;
  padding: 6px 0;
  border: none;
  border-radius: 8px;
  background: transparent;
  color: var(--text-secondary);
  font-size: 12px;
  font-weight: 600;
  font-family: var(--font);
  cursor: pointer;
  transition: all 0.2s ease;
}
.period-btn.active {
  background: var(--tab-active);
  color: var(--text-primary);
  box-shadow: 0 1px 4px var(--glass-shadow);
}
.chart-card {
  padding: 12px;
}
.chart-header {
  display: flex;
  justify-content: space-between;
  align-items: baseline;
  margin-bottom: 8px;
}
.chart-title {
  font-size: 13px;
  font-weight: 600;
  color: var(--text-primary);
}
.chart-subtitle {
  font-size: 11px;
  color: var(--text-secondary);
}
.chart-canvas {
  width: 100%;
  height: 120px;
  display: block;
  border-radius: 8px;
}
.chart-stats {
  display: flex;
  justify-content: space-around;
  margin-top: 10px;
  padding-top: 10px;
  border-top: 1px solid var(--glass-border);
}
.chart-stat {
  text-align: center;
}
.chart-stat-value {
  font-size: 18px;
  font-weight: 700;
  color: var(--text-primary);
}
.chart-stat-label {
  font-size: 10px;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.3px;
  margin-top: 2px;
}

/* ============================================
   TAB BAR
   ============================================ */
.tab-bar {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 84px;
  z-index: 30;
  background: var(--glass-bg);
  backdrop-filter: blur(40px) saturate(200%);
  -webkit-backdrop-filter: blur(40px) saturate(200%);
  border-top: 1px solid var(--glass-border);
  display: flex;
  align-items: flex-start;
  justify-content: space-around;
  padding-top: 8px;
}
.tab-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 3px;
  background: none;
  border: none;
  color: var(--text-tertiary);
  font-size: 10px;
  font-weight: 500;
  font-family: var(--font);
  cursor: pointer;
  padding: 4px 20px;
  transition: color 0.2s ease;
}
.tab-item.active {
  color: var(--blue);
}
.tab-item svg {
  width: 24px;
  height: 24px;
  transition: color 0.2s ease;
}

/* Home indicator */
.home-indicator {
  position: absolute;
  bottom: 8px;
  left: 50%;
  transform: translateX(-50%);
  width: 134px;
  height: 5px;
  border-radius: 3px;
  background: var(--home-indicator);
  z-index: 40;
}

/* ============================================
   ALERTS SCREEN
   ============================================ */
.alerts-header {
  font-size: 22px;
  font-weight: 700;
  color: var(--text-primary);
  margin-bottom: 16px;
  letter-spacing: -0.3px;
}
.alert-section {
  margin-bottom: 20px;
}
.section-label {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 10px;
}

/* Threshold slider */
.threshold-card {
  padding: 16px;
  margin-bottom: 12px;
}
.threshold-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
}
.threshold-name {
  font-size: 15px;
  font-weight: 600;
  color: var(--text-primary);
}
.threshold-value-display {
  font-size: 22px;
  font-weight: 700;
  color: var(--blue);
  letter-spacing: -1px;
}
.slider-container {
  position: relative;
  padding: 8px 0;
}
.slider-track {
  position: relative;
  height: 6px;
  border-radius: 3px;
  background: linear-gradient(90deg, var(--red) 0%, var(--yellow) 50%, var(--green) 100%);
  margin-bottom: 8px;
}
input[type="range"] {
  -webkit-appearance: none;
  appearance: none;
  width: 100%;
  height: 6px;
  border-radius: 3px;
  background: transparent;
  outline: none;
  position: relative;
  z-index: 2;
  margin: 0;
}
input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 28px;
  height: 28px;
  border-radius: 50%;
  background: white;
  box-shadow: 0 2px 8px rgba(0,0,0,0.3), 0 0 0 1px rgba(0,0,0,0.05);
  cursor: pointer;
  margin-top: -11px;
}
input[type="range"]::-webkit-slider-runnable-track {
  height: 6px;
  border-radius: 3px;
  background: linear-gradient(90deg, var(--red) 0%, var(--yellow) 50%, var(--green) 100%);
}
.slider-labels {
  display: flex;
  justify-content: space-between;
  font-size: 10px;
  color: var(--text-tertiary);
}
.threshold-context {
  font-size: 11px;
  color: var(--text-secondary);
  margin-top: 8px;
  line-height: 1.4;
  font-style: italic;
}

/* Toggle switch */
.alert-action-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 0;
  border-bottom: 1px solid var(--glass-border);
}
.alert-action-item:last-child {
  border-bottom: none;
}
.action-left {
  display: flex;
  align-items: center;
  gap: 10px;
  flex: 1;
}
.action-icon {
  width: 32px;
  height: 32px;
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 16px;
  flex-shrink: 0;
}
.action-icon.red { background: rgba(255, 59, 48, 0.15); }
.action-icon.blue { background: rgba(10, 132, 255, 0.15); }
.action-icon.orange { background: rgba(255, 159, 10, 0.15); }
.action-icon.green { background: rgba(48, 209, 88, 0.15); }
.action-icon.purple { background: rgba(191, 90, 242, 0.15); }
.action-icon.teal { background: rgba(48, 176, 199, 0.15); }

.action-label {
  font-size: 15px;
  color: var(--text-primary);
  font-weight: 400;
}
.action-sublabel {
  font-size: 11px;
  color: var(--text-secondary);
  margin-top: 1px;
}

/* iOS-style toggle */
.toggle-switch {
  position: relative;
  width: 51px;
  height: 31px;
  flex-shrink: 0;
}
.toggle-switch input {
  opacity: 0;
  width: 0;
  height: 0;
}
.toggle-slider {
  position: absolute;
  inset: 0;
  border-radius: 31px;
  background: var(--toggle-bg);
  cursor: pointer;
  transition: background 0.3s ease;
}
.toggle-slider::before {
  content: '';
  position: absolute;
  top: 2px;
  left: 2px;
  width: 27px;
  height: 27px;
  border-radius: 50%;
  background: white;
  box-shadow: 0 2px 4px rgba(0,0,0,0.2);
  transition: transform 0.3s ease;
}
.toggle-switch input:checked + .toggle-slider {
  background: var(--toggle-active);
}
.toggle-switch input:checked + .toggle-slider::before {
  transform: translateX(20px);
}

/* Contact input fields */
.contact-input-group {
  margin-top: 8px;
  padding-left: 42px;
  display: none;
}
.contact-input-group.visible {
  display: block;
}
.contact-input {
  width: 100%;
  padding: 10px 14px;
  background: var(--input-bg);
  border: 1px solid var(--input-border);
  border-radius: 10px;
  color: var(--text-primary);
  font-size: 14px;
  font-family: var(--font);
  outline: none;
  margin-bottom: 6px;
  transition: all 0.2s ease;
}
.contact-input:focus {
  border-color: var(--blue);
  background: rgba(10, 132, 255, 0.05);
}
.contact-input::placeholder {
  color: var(--text-tertiary);
}
.add-contact-btn {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 6px 12px;
  background: transparent;
  border: 1px dashed var(--glass-border);
  border-radius: 8px;
  color: var(--blue);
  font-size: 12px;
  font-weight: 500;
  font-family: var(--font);
  cursor: pointer;
  transition: all 0.2s ease;
}
.add-contact-btn:hover {
  background: rgba(10, 132, 255, 0.05);
}

/* Bottom padding for scrollable alerts */
.alerts-bottom-pad {
  height: 30px;
}

/* ============================================
   RESPONSIVE
   ============================================ */
@media (max-width: 440px) {
  .iphone-wrapper {
    transform: scale(0.85);
    transform-origin: top center;
  }
}
@media (max-width: 380px) {
  .iphone-wrapper {
    transform: scale(0.75);
    transform-origin: top center;
  }
}

/* ============================================
   ANIMATIONS
   ============================================ */
@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after {
    animation-duration: 0.01ms !important;
    transition-duration: 0.01ms !important;
  }
}
</style>
</head>
<body>

<!-- Page Header -->
<div class="page-header">
  <h1>O2 Pulse &mdash; Concept A: Clinical Monitor</h1>
  <p>Interactive iPhone mockup &middot; Liquid Glass design</p>
  <button class="theme-toggle-page" id="themeToggle" aria-label="Toggle theme">
    <span class="theme-icon" id="themeIcon">&#9790;</span>
    <span id="themeLabel">Dark</span>
  </button>
</div>

<!-- iPhone Frame -->
<div class="iphone-wrapper">
  <div class="iphone-frame">
    <div class="mesh-bg"></div>
    <div class="dynamic-island"></div>

    <!-- iOS Status Bar -->
    <div class="status-bar">
      <span>9:41</span>
      <div class="status-bar-right">
        <svg viewBox="0 0 16 16" fill="currentColor"><path d="M1 11.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-3zm3.5-2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v5a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-5zm3.5-2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-7zm3.5-2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-9z"/></svg>
        <svg viewBox="0 0 16 16" fill="currentColor"><path d="M0 8.5a.5.5 0 0 1 .5-.5h7.793L5.854 5.354a.5.5 0 1 1 .708-.708l3 3a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708-.708L8.293 8.5H.5a.5.5 0 0 1-.5-.5z" transform="rotate(-45 8 8)"/></svg>
        <svg viewBox="0 0 24 12" fill="currentColor"><rect x="0" y="0" width="22" height="12" rx="3" ry="3" fill="none" stroke="currentColor" stroke-width="1.5"/><rect x="2" y="2" width="15" height="8" rx="1.5" ry="1.5" fill="currentColor"/><rect x="23" y="3.5" width="2" height="5" rx="1" fill="currentColor" opacity="0.4"/></svg>
      </div>
    </div>

    <!-- App Content -->
    <div class="app-content">

      <!-- ===== MAIN SCREEN ===== -->
      <div class="app-screen active" id="screenMain">

        <!-- Connection Status -->
        <div class="connection-pill">
          <div class="connection-dot"></div>
          <svg class="watch-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect x="5" y="2" width="14" height="20" rx="3"/>
            <line x1="9" y1="2" x2="9" y2="4"/>
            <line x1="15" y1="2" x2="15" y2="4"/>
            <line x1="9" y1="20" x2="9" y2="22"/>
            <line x1="15" y1="20" x2="15" y2="22"/>
          </svg>
          <span>Connected</span>
          <span class="battery">87%</span>
        </div>

        <!-- SpO2 Gauge -->
        <div class="spo2-section">
          <div class="spo2-gauge">
            <svg viewBox="0 0 200 200">
              <circle class="gauge-glow" cx="100" cy="100" r="80"
                stroke-dasharray="0 502"
                id="gaugeGlow"/>
              <circle class="gauge-track" cx="100" cy="100" r="80"
                stroke-dasharray="377 502"/>
              <circle class="gauge-fill" cx="100" cy="100" r="80"
                stroke="var(--green)"
                stroke-dasharray="0 502"
                id="gaugeFill"/>
            </svg>
            <div class="spo2-value-group">
              <div>
                <span class="spo2-value" id="spo2Value">--</span><span class="spo2-unit">%</span>
              </div>
              <div class="spo2-label">Blood Oxygen</div>
              <div class="spo2-status" id="spo2Status">Normal</div>
            </div>
          </div>
        </div>

        <!-- Pulse -->
        <div class="pulse-section">
          <span class="pulse-heart">&hearts;</span>
          <span class="pulse-value" id="pulseValue">--</span>
          <span class="pulse-unit">bpm</span>
        </div>

        <!-- PPG Waveform -->
        <div class="ppg-section">
          <div class="glass-card ppg-card">
            <div class="ppg-label">Live Waveform</div>
            <canvas class="ppg-canvas" id="ppgCanvas"></canvas>
          </div>
        </div>

        <!-- Chart Section -->
        <div class="chart-section">
          <div class="period-selector">
            <button class="period-btn active" data-period="D">D</button>
            <button class="period-btn" data-period="W">W</button>
            <button class="period-btn" data-period="M">M</button>
            <button class="period-btn" data-period="6M">6M</button>
            <button class="period-btn" data-period="Y">Y</button>
          </div>
          <div class="glass-card chart-card">
            <div class="chart-header">
              <span class="chart-title">SpO2 History</span>
              <span class="chart-subtitle" id="chartSubtitle">Today</span>
            </div>
            <canvas class="chart-canvas" id="chartCanvas"></canvas>
            <div class="chart-stats">
              <div class="chart-stat">
                <div class="chart-stat-value" id="statAvg">--</div>
                <div class="chart-stat-label">Average</div>
              </div>
              <div class="chart-stat">
                <div class="chart-stat-value" id="statMin">--</div>
                <div class="chart-stat-label">Minimum</div>
              </div>
              <div class="chart-stat">
                <div class="chart-stat-value" id="statMax">--</div>
                <div class="chart-stat-label">Maximum</div>
              </div>
            </div>
          </div>
        </div>

      </div>

      <!-- ===== ALERTS SCREEN ===== -->
      <div class="app-screen" id="screenAlerts">

        <div class="alerts-header">Notifications</div>

        <!-- O2 Threshold -->
        <div class="alert-section">
          <div class="section-label">O2 Alert Threshold</div>
          <div class="glass-card threshold-card">
            <div class="threshold-header">
              <span class="threshold-name">SpO2 Low Alert</span>
              <span class="threshold-value-display" id="o2ThresholdDisplay">92%</span>
            </div>
            <div class="slider-container">
              <input type="range" id="o2Slider" min="80" max="100" value="92" step="1">
            </div>
            <div class="slider-labels">
              <span>80%</span>
              <span>90%</span>
              <span>100%</span>
            </div>
            <div class="threshold-context" id="o2Context">Alert when SpO2 drops below 92%. Recommended for general wellness monitoring.</div>
          </div>
        </div>

        <!-- Pulse Thresholds -->
        <div class="alert-section">
          <div class="section-label">Pulse Alert Thresholds</div>
          <div class="glass-card threshold-card">
            <div class="threshold-header">
              <span class="threshold-name">High Pulse Alert</span>
              <span class="threshold-value-display" id="pulseHighDisplay">120 bpm</span>
            </div>
            <div class="slider-container">
              <input type="range" id="pulseHighSlider" min="80" max="200" value="120" step="5">
            </div>
            <div class="slider-labels">
              <span>80</span>
              <span>140</span>
              <span>200</span>
            </div>
          </div>
          <div class="glass-card threshold-card" style="margin-top:8px">
            <div class="threshold-header">
              <span class="threshold-name">Low Pulse Alert</span>
              <span class="threshold-value-display" id="pulseLowDisplay">50 bpm</span>
            </div>
            <div class="slider-container">
              <input type="range" id="pulseLowSlider" min="30" max="80" value="50" step="5">
            </div>
            <div class="slider-labels">
              <span>30</span>
              <span>55</span>
              <span>80</span>
            </div>
          </div>
        </div>

        <!-- Alert Actions -->
        <div class="alert-section">
          <div class="section-label">Alert Actions</div>
          <div class="glass-card" style="padding:4px 16px">

            <!-- Red screen watch -->
            <div class="alert-action-item">
              <div class="action-left">
                <div class="action-icon red">&#9888;</div>
                <div>
                  <div class="action-label">Red Screen on Watch</div>
                  <div class="action-sublabel">Flash watch screen red</div>
                </div>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" checked>
                <span class="toggle-slider"></span>
              </label>
            </div>

            <!-- Red screen app -->
            <div class="alert-action-item">
              <div class="action-left">
                <div class="action-icon red">&#128241;</div>
                <div>
                  <div class="action-label">Critical Alert on Phone</div>
                  <div class="action-sublabel">Red screen + push notification</div>
                </div>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" checked>
                <span class="toggle-slider"></span>
              </label>
            </div>

            <!-- Vibration watch -->
            <div class="alert-action-item">
              <div class="action-left">
                <div class="action-icon orange">&#128243;</div>
                <div>
                  <div class="action-label">Vibration on Watch</div>
                  <div class="action-sublabel">Haptic feedback alert</div>
                </div>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" checked>
                <span class="toggle-slider"></span>
              </label>
            </div>

            <!-- Vibration phone -->
            <div class="alert-action-item">
              <div class="action-left">
                <div class="action-icon orange">&#128244;</div>
                <div>
                  <div class="action-label">Vibration on Phone</div>
                </div>
              </div>
              <label class="toggle-switch">
                <input type="checkbox">
                <span class="toggle-slider"></span>
              </label>
            </div>

            <!-- Sound watch -->
            <div class="alert-action-item">
              <div class="action-left">
                <div class="action-icon blue">&#128266;</div>
                <div>
                  <div class="action-label">Sound on Watch</div>
                  <div class="action-sublabel">Audible alarm</div>
                </div>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" checked>
                <span class="toggle-slider"></span>
              </label>
            </div>

            <!-- Sound app -->
            <div class="alert-action-item">
              <div class="action-left">
                <div class="action-icon blue">&#128264;</div>
                <div>
                  <div class="action-label">Sound on Phone</div>
                </div>
              </div>
              <label class="toggle-switch">
                <input type="checkbox">
                <span class="toggle-slider"></span>
              </label>
            </div>

            <!-- Email -->
            <div class="alert-action-item" style="flex-wrap:wrap">
              <div class="action-left">
                <div class="action-icon purple">&#9993;</div>
                <div>
                  <div class="action-label">Email Alerts</div>
                  <div class="action-sublabel">Send email notifications</div>
                </div>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" data-toggle-input="emailInputs">
                <span class="toggle-slider"></span>
              </label>
              <div class="contact-input-group" id="emailInputs">
                <input class="contact-input" type="email" placeholder="email@example.com">
                <button class="add-contact-btn">+ Add another email</button>
              </div>
            </div>

            <!-- SMS -->
            <div class="alert-action-item" style="flex-wrap:wrap">
              <div class="action-left">
                <div class="action-icon green">&#128172;</div>
                <div>
                  <div class="action-label">SMS Alerts</div>
                  <div class="action-sublabel">Text message notifications</div>
                </div>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" data-toggle-input="smsInputs">
                <span class="toggle-slider"></span>
              </label>
              <div class="contact-input-group" id="smsInputs">
                <input class="contact-input" type="tel" placeholder="+1 (555) 000-0000">
                <button class="add-contact-btn">+ Add another number</button>
              </div>
            </div>

            <!-- Call -->
            <div class="alert-action-item" style="flex-wrap:wrap">
              <div class="action-left">
                <div class="action-icon teal">&#128222;</div>
                <div>
                  <div class="action-label">Emergency Call</div>
                  <div class="action-sublabel">Auto-dial on critical alert</div>
                </div>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" data-toggle-input="callInputs">
                <span class="toggle-slider"></span>
              </label>
              <div class="contact-input-group" id="callInputs">
                <input class="contact-input" type="tel" placeholder="+1 (555) 000-0000">
                <button class="add-contact-btn">+ Add another number</button>
              </div>
            </div>

          </div>
        </div>

        <div class="alerts-bottom-pad"></div>
      </div>

    </div>

    <!-- Tab Bar -->
    <div class="tab-bar">
      <button class="tab-item active" data-tab="screenMain">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M22 12h-4l-3 9L9 3l-3 9H2"/>
        </svg>
        <span>Monitor</span>
      </button>
      <button class="tab-item" data-tab="screenAlerts">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/>
          <path d="M13.73 21a2 2 0 0 1-3.46 0"/>
        </svg>
        <span>Alerts</span>
      </button>
    </div>

    <div class="home-indicator"></div>
  </div>
</div>

<script>
// ============================================
// THEME TOGGLE
// ============================================
const themeToggle = document.getElementById('themeToggle');
const themeIcon = document.getElementById('themeIcon');
const themeLabel = document.getElementById('themeLabel');
const root = document.documentElement;

function setTheme(theme) {
  root.setAttribute('data-theme', theme);
  themeIcon.innerHTML = theme === 'dark' ? '&#9790;' : '&#9788;';
  themeLabel.textContent = theme === 'dark' ? 'Dark' : 'Light';
  localStorage.setItem('o2pulse-theme', theme);
  // Redraw charts with new colors
  drawChart();
}

themeToggle.addEventListener('click', () => {
  const current = root.getAttribute('data-theme');
  setTheme(current === 'dark' ? 'light' : 'dark');
});

// Restore saved theme
const savedTheme = localStorage.getItem('o2pulse-theme');
if (savedTheme) setTheme(savedTheme);

// ============================================
// TAB SWITCHING
// ============================================
document.querySelectorAll('.tab-item').forEach(tab => {
  tab.addEventListener('click', () => {
    document.querySelectorAll('.tab-item').forEach(t => t.classList.remove('active'));
    document.querySelectorAll('.app-screen').forEach(s => s.classList.remove('active'));
    tab.classList.add('active');
    document.getElementById(tab.dataset.tab).classList.add('active');
  });
});

// ============================================
// PERIOD SELECTOR
// ============================================
const periodLabels = { D: 'Today', W: 'This Week', M: 'This Month', '6M': '6 Months', Y: 'This Year' };
document.querySelectorAll('.period-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    document.querySelectorAll('.period-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    document.getElementById('chartSubtitle').textContent = periodLabels[btn.dataset.period];
    generateChartData(btn.dataset.period);
    drawChart();
  });
});

// ============================================
// TOGGLE -> INPUT VISIBILITY
// ============================================
document.querySelectorAll('[data-toggle-input]').forEach(toggle => {
  toggle.addEventListener('change', () => {
    const target = document.getElementById(toggle.dataset.toggleInput);
    if (target) target.classList.toggle('visible', toggle.checked);
  });
});

// ============================================
// THRESHOLD SLIDERS
// ============================================
const o2Slider = document.getElementById('o2Slider');
const o2Display = document.getElementById('o2ThresholdDisplay');
const o2Context = document.getElementById('o2Context');
o2Slider.addEventListener('input', () => {
  const v = parseInt(o2Slider.value);
  o2Display.textContent = v + '%';
  if (v >= 95) o2Context.textContent = `Alert when SpO2 drops below ${v}%. Very sensitive \u2014 may trigger often during sleep.`;
  else if (v >= 90) o2Context.textContent = `Alert when SpO2 drops below ${v}%. Recommended for general wellness monitoring.`;
  else if (v >= 85) o2Context.textContent = `Alert when SpO2 drops below ${v}%. Common threshold for sleep apnea monitoring.`;
  else o2Context.textContent = `Alert when SpO2 drops below ${v}%. Clinical threshold \u2014 only alerts on severe desaturation.`;
});

const pulseHighSlider = document.getElementById('pulseHighSlider');
const pulseHighDisplay = document.getElementById('pulseHighDisplay');
pulseHighSlider.addEventListener('input', () => {
  pulseHighDisplay.textContent = pulseHighSlider.value + ' bpm';
});

const pulseLowSlider = document.getElementById('pulseLowSlider');
const pulseLowDisplay = document.getElementById('pulseLowDisplay');
pulseLowSlider.addEventListener('input', () => {
  pulseLowDisplay.textContent = pulseLowSlider.value + ' bpm';
});

// ============================================
// SIMULATED VITAL SIGNS
// ============================================
let currentSpO2 = 97;
let currentPulse = 72;

function getGaugeColor(spo2) {
  if (spo2 >= 90) return 'var(--green)';
  if (spo2 >= 82) return 'var(--yellow)';
  return 'var(--red)';
}

function getStatusText(spo2) {
  if (spo2 >= 95) return 'Normal';
  if (spo2 >= 90) return 'Slightly Low';
  if (spo2 >= 82) return 'Warning';
  return 'Critical';
}

function getStatusBg(spo2) {
  if (spo2 >= 90) return 'rgba(48, 209, 88, 0.15)';
  if (spo2 >= 82) return 'rgba(255, 214, 10, 0.15)';
  return 'rgba(255, 59, 48, 0.15)';
}

function getStatusColor(spo2) {
  if (spo2 >= 90) return 'var(--green)';
  if (spo2 >= 82) return 'var(--yellow)';
  return 'var(--red)';
}

function updateVitals() {
  // Simulate slight fluctuations
  currentSpO2 += (Math.random() - 0.48) * 0.5;
  currentSpO2 = Math.max(85, Math.min(100, currentSpO2));
  const displaySpO2 = Math.round(currentSpO2);

  currentPulse += (Math.random() - 0.5) * 2;
  currentPulse = Math.max(55, Math.min(110, currentPulse));
  const displayPulse = Math.round(currentPulse);

  // Update SpO2 display
  document.getElementById('spo2Value').textContent = displaySpO2;
  document.getElementById('pulseValue').textContent = displayPulse;

  // Update gauge
  const maxArc = 377; // 75% of circumference for 270-degree arc
  const fillAmount = ((displaySpO2 - 80) / 20) * maxArc;
  const color = getGaugeColor(displaySpO2);
  const gaugeFill = document.getElementById('gaugeFill');
  const gaugeGlow = document.getElementById('gaugeGlow');
  gaugeFill.setAttribute('stroke-dasharray', `${fillAmount} 502`);
  gaugeFill.setAttribute('stroke', color);
  gaugeFill.style.filter = `drop-shadow(0 0 8px ${color === 'var(--green)' ? '#30d158' : color === 'var(--yellow)' ? '#ffd60a' : '#ff3b30'})`;
  gaugeGlow.setAttribute('stroke-dasharray', `${fillAmount} 502`);
  gaugeGlow.setAttribute('stroke', color);

  // Update status
  const statusEl = document.getElementById('spo2Status');
  statusEl.textContent = getStatusText(displaySpO2);
  statusEl.style.background = getStatusBg(displaySpO2);
  statusEl.style.color = getStatusColor(displaySpO2);
}

// Initial update + interval
updateVitals();
setInterval(updateVitals, 2000);

// ============================================
// PPG WAVEFORM (Canvas)
// ============================================
const ppgCanvas = document.getElementById('ppgCanvas');
const ppgCtx = ppgCanvas.getContext('2d');
let ppgOffset = 0;

function resizePPG() {
  const rect = ppgCanvas.parentElement;
  ppgCanvas.width = ppgCanvas.offsetWidth * 2;
  ppgCanvas.height = ppgCanvas.offsetHeight * 2;
  ppgCtx.scale(2, 2);
}

function ppgWave(x) {
  // Simulate realistic PPG waveform
  const period = 80; // pixels per beat
  const t = ((x % period) / period);
  if (t < 0.1) return Math.sin(t / 0.1 * Math.PI) * 0.9; // Systolic upstroke
  if (t < 0.18) return 0.9 - (t - 0.1) / 0.08 * 0.5; // Systolic peak descent
  if (t < 0.25) return 0.4 + Math.sin((t - 0.18) / 0.07 * Math.PI) * 0.15; // Dicrotic notch
  if (t < 0.35) return 0.55 - (t - 0.25) / 0.1 * 0.3; // Diastolic descent
  return 0.25 * Math.exp(-(t - 0.35) * 4); // Diastolic runoff
}

function drawPPG() {
  const w = ppgCanvas.offsetWidth;
  const h = ppgCanvas.offsetHeight;
  const isDark = root.getAttribute('data-theme') === 'dark';

  ppgCtx.clearRect(0, 0, w, h);

  // Draw waveform
  ppgCtx.beginPath();
  const lineColor = isDark ? '#64d2ff' : '#0a84ff';
  ppgCtx.strokeStyle = lineColor;
  ppgCtx.lineWidth = 1.5;
  ppgCtx.lineJoin = 'round';

  for (let x = 0; x < w; x++) {
    const val = ppgWave(x + ppgOffset);
    const y = h - 8 - val * (h - 16);
    if (x === 0) ppgCtx.moveTo(x, y);
    else ppgCtx.lineTo(x, y);
  }
  ppgCtx.stroke();

  // Glow effect
  ppgCtx.save();
  ppgCtx.globalAlpha = 0.15;
  ppgCtx.filter = 'blur(4px)';
  ppgCtx.strokeStyle = lineColor;
  ppgCtx.lineWidth = 4;
  ppgCtx.beginPath();
  for (let x = 0; x < w; x++) {
    const val = ppgWave(x + ppgOffset);
    const y = h - 8 - val * (h - 16);
    if (x === 0) ppgCtx.moveTo(x, y);
    else ppgCtx.lineTo(x, y);
  }
  ppgCtx.stroke();
  ppgCtx.restore();

  ppgOffset += 1.2;
  requestAnimationFrame(drawPPG);
}

// ============================================
// HISTORY CHART (Canvas)
// ============================================
const chartCanvas = document.getElementById('chartCanvas');
const chartCtx = chartCanvas.getContext('2d');
let chartData = [];

function generateChartData(period) {
  const counts = { D: 24, W: 7, M: 30, '6M': 26, Y: 12 };
  const n = counts[period] || 24;
  chartData = [];
  for (let i = 0; i < n; i++) {
    const base = 95 + Math.random() * 4;
    const dip = Math.random() < 0.15 ? -(Math.random() * 6 + 2) : 0;
    chartData.push(Math.max(82, Math.min(100, base + dip)));
  }
  // Update stats
  const avg = chartData.reduce((a, b) => a + b, 0) / chartData.length;
  document.getElementById('statAvg').textContent = Math.round(avg) + '%';
  document.getElementById('statMin').textContent = Math.round(Math.min(...chartData)) + '%';
  document.getElementById('statMax').textContent = Math.round(Math.max(...chartData)) + '%';
}

function resizeChart() {
  chartCanvas.width = chartCanvas.offsetWidth * 2;
  chartCanvas.height = chartCanvas.offsetHeight * 2;
  chartCtx.scale(2, 2);
}

function drawChart() {
  const w = chartCanvas.offsetWidth;
  const h = chartCanvas.offsetHeight;
  const isDark = root.getAttribute('data-theme') === 'dark';

  chartCtx.clearRect(0, 0, w, h);

  if (chartData.length === 0) return;

  const minY = 80, maxY = 100;
  const padL = 0, padR = 0, padT = 4, padB = 4;
  const chartW = w - padL - padR;
  const chartH = h - padT - padB;

  // Safe zone (90-100%)
  const safeTop = padT + chartH * (1 - (100 - minY) / (maxY - minY));
  const safeBot = padT + chartH * (1 - (90 - minY) / (maxY - minY));
  const greenColor = isDark ? 'rgba(48, 209, 88, 0.08)' : 'rgba(48, 209, 88, 0.1)';
  chartCtx.fillStyle = greenColor;
  chartCtx.fillRect(padL, safeTop, chartW, safeBot - safeTop);

  // Warning zone (82-90%)
  const warnBot = padT + chartH * (1 - (82 - minY) / (maxY - minY));
  const yellowColor = isDark ? 'rgba(255, 214, 10, 0.04)' : 'rgba(255, 214, 10, 0.06)';
  chartCtx.fillStyle = yellowColor;
  chartCtx.fillRect(padL, safeBot, chartW, warnBot - safeBot);

  // 90% threshold line
  chartCtx.beginPath();
  chartCtx.setLineDash([4, 4]);
  chartCtx.strokeStyle = isDark ? 'rgba(255,255,255,0.12)' : 'rgba(0,0,0,0.1)';
  chartCtx.lineWidth = 0.5;
  const y90 = padT + chartH * (1 - (90 - minY) / (maxY - minY));
  chartCtx.moveTo(padL, y90);
  chartCtx.lineTo(padL + chartW, y90);
  chartCtx.stroke();
  chartCtx.setLineDash([]);

  // Data points
  const points = chartData.map((val, i) => ({
    x: padL + (i / (chartData.length - 1)) * chartW,
    y: padT + chartH * (1 - (val - minY) / (maxY - minY))
  }));

  // Area fill
  chartCtx.beginPath();
  chartCtx.moveTo(points[0].x, points[0].y);
  for (let i = 1; i < points.length; i++) {
    const cp1x = (points[i - 1].x + points[i].x) / 2;
    chartCtx.bezierCurveTo(cp1x, points[i - 1].y, cp1x, points[i].y, points[i].x, points[i].y);
  }
  chartCtx.lineTo(points[points.length - 1].x, padT + chartH);
  chartCtx.lineTo(points[0].x, padT + chartH);
  chartCtx.closePath();
  const grad = chartCtx.createLinearGradient(0, padT, 0, padT + chartH);
  if (isDark) {
    grad.addColorStop(0, 'rgba(48, 209, 88, 0.25)');
    grad.addColorStop(0.5, 'rgba(48, 209, 88, 0.08)');
    grad.addColorStop(1, 'rgba(48, 209, 88, 0.01)');
  } else {
    grad.addColorStop(0, 'rgba(48, 209, 88, 0.3)');
    grad.addColorStop(0.5, 'rgba(48, 209, 88, 0.1)');
    grad.addColorStop(1, 'rgba(48, 209, 88, 0.02)');
  }
  chartCtx.fillStyle = grad;
  chartCtx.fill();

  // Line
  chartCtx.beginPath();
  chartCtx.moveTo(points[0].x, points[0].y);
  for (let i = 1; i < points.length; i++) {
    const cp1x = (points[i - 1].x + points[i].x) / 2;
    chartCtx.bezierCurveTo(cp1x, points[i - 1].y, cp1x, points[i].y, points[i].x, points[i].y);
  }
  chartCtx.strokeStyle = isDark ? '#30d158' : '#28a745';
  chartCtx.lineWidth = 2;
  chartCtx.stroke();

  // Dots
  points.forEach((p, i) => {
    const val = chartData[i];
    let color = '#30d158';
    if (val < 82) color = '#ff3b30';
    else if (val < 90) color = '#ffd60a';

    chartCtx.beginPath();
    chartCtx.arc(p.x, p.y, 3, 0, Math.PI * 2);
    chartCtx.fillStyle = color;
    chartCtx.fill();

    // Glow for critical
    if (val < 90) {
      chartCtx.beginPath();
      chartCtx.arc(p.x, p.y, 6, 0, Math.PI * 2);
      chartCtx.fillStyle = color === '#ff3b30' ? 'rgba(255,59,48,0.2)' : 'rgba(255,214,10,0.2)';
      chartCtx.fill();
    }
  });
}

// ============================================
// INIT
// ============================================
function init() {
  resizePPG();
  resizeChart();
  generateChartData('D');
  drawChart();
  drawPPG();
}

// Handle resize
window.addEventListener('resize', () => {
  resizePPG();
  resizeChart();
  drawChart();
});

// Start when loaded
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', init);
} else {
  init();
}
</script>
</body>
</html>
